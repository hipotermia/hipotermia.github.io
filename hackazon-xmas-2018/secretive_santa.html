<h3>[50] Book Of Children</h3>

<p class="challenge-description">Last year Santa moved his book of Children to a digital copy on a USB drive. However,
    some of his helper elves accidentally deleted some files of his digital book. Can you help save this years
    Christmas?</p>

<p>In this challenge a <code>BookOfChildren.img</code> file is given.</p>

<p>Using <code>foremost</code> is possible to recover the deleted files in the disc image.</p>

<pre class="prettyprint">
root@kali:~/hackazon/secretive_santa# foremost BookOfChildren.img 
Processing: BookOfChildren.img
|*foundat=Evidence/UT	
foundat=Evidence/Jimmy.jpgUT	
foundat=Evidence/Sasha.pngUT	
foundat=Evidence/Eric.jpgUT	
foundat=Evidence/Annie.jpgUT	
foundat=Evidence/Geoffry.jpgUT	
foundat=Evidence/Riley.jpgUT	
*****|
</pre>

In one of the pictures extracted there's the flag.

<img class="img-fluid" src="/static/img/hackazon-xmas-2018/secretive_santa/Sasha.png">

<h3>[125] Santas Evidence</h3>

<p class="challenge-description">Santa stored some evidence on naughty kids on the drive somewhere too. Without the
    evidence his quality assurance elves will never sign off on the coal for them!</p>

<p>Mount the image to access to its content.</p>

<pre class="prettyprint">
root@kali:~/hackazon/secretive_santa# mount BookOfChildren.img /mnt/bookofchildren/
root@kali:~/hackazon/secretive_santa# cd /mnt/bookofchildren/
root@kali:/mnt/bookofchildren# ls -la
total 5152
drwxr-xr-x 4 root root    4096 Dec  9 20:55 .
drwxr-xr-x 3 root root    4096 Jan  6 19:27 ..
drwxr-xr-x 2 root root    4096 Dec  9 20:55 ...
-rw-r--r-- 1 root root     261 Dec  9 20:49 listChildren
drwx------ 2 root root   16384 Dec  9 20:48 lost+found
-rw-r--r-- 1 root root 5242880 Dec 21 12:43 presents
</pre>

<p>In one of the files there's the list of kids and the flag.</p>

<pre class="prettyprint">
root@kali:/mnt/bookofchildren# cat listChildren 
Kids that behaved:
    Ariel
    Bailey
    Drew
    Harley
    Perry
    Robin
    Reed
    Tory

Kids that should get coal:
    Annie
    Eric
    Geoffry
    Jimmy
    Riley
    Sasha

Additional information
    CTF{OhDeerItsChristmas}
</pre>

<h3>[200] The Locked Presents</h3>

<p class="challenge-description">Santa put the presents in a secured magical box. The key for this box was also hidden
    somewhere, but it seems to have gotten lost. Can you find the key and open the magical box?</p>

<p>The magical box which is described above is the <code>presents</code> file which is an encryptred LUKS file and a
    master key is needed to decrypt it.</p>

<pre class="prettyprint">root@kali:/mnt/bookofchildren# file presents 
presents: LUKS encrypted file, ver 1 [aes, xts-plain64, sha256] UUID: 93db1a26-3c03-43d6-bfd1-795de52a5d76</pre>

<p>Listing the directories in the image there's a hidden folder <code>...</code> which has a <code>password.txt</code>
    file with a password.</p>

<pre class="prettyprint">
root@kali:/mnt/bookofchildren# cat .../password.txt 
FelizNavidad
</pre>

<p>Using the password obtained it's possible to decrypt the LUKS file and see the content.</p>

<pre class="prettyprint">
root@kali:/mnt/bookofchildren# cryptsetup luksOpen presents caca
Enter passphrase for presents: FelizNavidad</pre>

<p>One of the images contains the flag.</p>

<img class="img-fluid" src="/static/img/hackazon-xmas-2018/secretive_santa/1.PNG">
